{% extends 'base/body_tabs.html' %}

{% block content %}
    {% for weather_provider, values_set, weather_city in forecast %}
        <div class='table-responsive'>
        <table class='table table-condensed'>
            <caption>{%  if weather_city %}<em>{{ weather_city }}</em>. {% endif %}Прогноз погоды по данным <em>{{ weather_provider }}</em></caption>
            {% for field, caption, measure, values in values_set %}
                <tr align='center'>
                    <th class='weather'>{{ caption }}
                        {% if measure %}
                            , <small><em>{{ measure }}</em></small>
                        {% endif %}
                    </th>
                    {% if field == 'datetime' %}
                        {% for forecast_weekday, forecast_date, forecast_time in values %}
                            <td class='weather'>
                                {{ forecast_weekday }}<br><nobr>{{ forecast_date }}</nobr><br>{{ forecast_time }}
                            </td>
                        {% endfor %}
                    {% elif field == 'clouds' %}
                        {% for file_img, clouds, descr, bg_color in values %}
                            <td class='{{ bg_color }}_c'>
                                <attr title='{{ descr }}{% if clouds %} (облачность {{ clouds }}%){% endif %}'>
                                    {% if file_img == 'na.png' %}
                                        <img src='{{ STATIC_URL }}img/{{ file_img }}' width='30' height='25'/>
                                    {%  else %}
                                        <img src='{{ STATIC_URL }}img/weather/{{ file_img }}' width='30' height='25'/>
                                    {%  endif %}
                                </attr>
                            </td>
                        {% endfor %}
                    {% elif field == 'precipitation' %}
                        {% for file_img, precipitation, descr, bg_color in values %}
                            <td class='{{ bg_color }}_f'>
                                <attr title='{{ descr }}{% if precipitation %} ({{ precipitation }}мм воды / 6 часов{% endif %}'>
                                    {% if file_img == 'na.png' %}
                                        <img src='{{ STATIC_URL }}img/{{ file_img }}' width='30' height='25'/>
                                    {% else %}
                                        <img src='{{ STATIC_URL }}img/weather/{{ file_img }}' width='18' height='27'/>
                                    {% endif %}
                                </attr>
                            </td>
                        {% endfor %}
                    {% elif field == 'wind_speed' %}
                        {% for wind_speed, wind_dir in values %}
                            <td class='weather'>{{ wind_speed }}
                                {% if wind_speed %}
                                    <img style='
                                            -moz-transform: rotate({{ wind_dir }}deg);
                                            -ms-transform: rotate({{ wind_dir }}deg);
                                            -webkit-transform:rotate({{ wind_dir }}deg);
                                            -o-transform: rotate({{ wind_dir }}deg);
                                            transform: rotate({{ wind_dir }}deg);
                                        '
                                        src='{{ STATIC_URL }}img/weather/wd.png'
                                        width='24'
                                        height='24'
                                    />
                                {% endif %}    
                            </td>
                        {% endfor %}
                    {% else %}
                        {% for value in values %}
                            <td class='weather'>{{ value }}</td>
                        {% endfor %}
                    {% endif %}
            {% endfor %}
        </table>
        </div>
    {% endfor %}
{% endblock %}
